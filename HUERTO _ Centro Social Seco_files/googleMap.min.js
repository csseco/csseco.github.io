define("googleMap",["lodash","coreUtils","santa-components","componentsCore","skins","reactDOM","components"],function(e,t,a,n,o,i,r){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=778)}({0:function(t,a){t.exports=e},1:function(e,a){e.exports=t},2:function(e,t){e.exports=a},20:function(e,t){e.exports=r},3:function(e,t){e.exports=n},5:function(e,t){e.exports=o},7:function(e,t){e.exports=i},778:function(e,t,a){var n,o;n=[a(2),a(0),a(1),a(7),a(20),a(5),a(779),a(3)],void 0===(o=function(e,t,a,n,o,i,r,s){"use strict";var p=["da","de","en","es","fr","it","ja","ko","nl","no","pl","pt","ru","sv","tr"],d=14,u={pt:"pt-BR"},l=function(e){var a=e.compProp.language,n=e.userLanguage,o="userLang"===a?n:a,i=t.includes(p,o)?o:"en";return u[i]||i};function c(e,t){return a.googleMapUtils.getGoogleMapsData(e,t)}function m(e,a){if(!t.get(a,"data.locations"))return{zoom:d,center:{}};var n=t.get(e,["zoom"],a.props.zoom||d),o=a.data.locations[a.data.defaultLocation];return{zoom:n,center:t.get(e,["center"],{longitude:o.longitude,latitude:o.latitude})}}var f={displayName:"GoogleMap",mixins:[s.mixins.skinBasedComp,e.mixins.compStateMixin(m)],statics:{compSpecificIsDomOnlyOverride:function(){return!1},behaviors:{getVisibleMarkers:{methodName:"getVisibleMarkers"},setMapZoom:{methodName:"setMapZoom",params:["zoom"]},setMapCenter:{methodName:"setMapCenter",params:["longitude","latitude"]}}},propTypes:{compData:e.santaTypesDefinitions.Component.compData.isRequired,compProp:e.santaTypesDefinitions.Component.compProp.isRequired,structure:e.santaTypesDefinitions.Component.structure.isRequired,santaBase:e.santaTypesDefinitions.santaBase.isRequired,cannotHideIframeWithinRoundedCorners:e.santaTypesDefinitions.mobile.cannotHideIframeWithinRoundedCorners.isRequired,userLanguage:e.santaTypesDefinitions.WixUserSantaTypes.userLanguage.isRequired,componentPreviewState:e.santaTypesDefinitions.RenderFlags.componentPreviewState,isPreviewMode:e.santaTypesDefinitions.isPreviewMode.isRequired,componentViewMode:e.santaTypesDefinitions.RenderFlags.componentViewMode,isExperimentOpen:e.santaTypesDefinitions.isExperimentOpen,locations:e.santaTypesDefinitions.GoogleMap.locations},getInitialState:function(){var e={};return this.props.cannotHideIframeWithinRoundedCorners()&&(e.$corners="squared"),this.restartMap(this.props),t.assign(m(null,{props:this.props.compProp,data:this.props.compData}),e)},componentDidMount:function(){this.iFrameNode=n.findDOMNode(this.refs.iframe),this.iFrameNode.onload=function(){var e=this.props.isExperimentOpen("sv_googleMapsRevamp");e&&window.addEventListener("message",this.googleMapsMessageHandler);var t=c(this.props,e);this.updateMapParams(t)}.bind(this)},googleMapsMessageHandler:function(e){try{var t=JSON.parse(e.data);"MAP_CLICKED"===t.type?this.onMapClicked(t.data):"MARKER_CLICKED"===t.type?this.onMarkerClicked(t.data):"ZOOM_UPDATED"===t.type?this.zoomChanged(t.data):"CENTER_UPDATED"===t.type&&this.centerChanged(t.data)}catch(e){return}},componentWillUnmount:function(){window.removeEventListener("message",this.googleMapsMessageHandler)},setMapZoom:function(e){this.setState({zoom:e}),n.findDOMNode(this.refs.iframe).contentWindow.postMessage({type:"SET_ZOOM",data:e},"*")},setMapCenter:function(e,t){this.setState({center:{longitude:e,latitude:t}}),n.findDOMNode(this.refs.iframe).contentWindow.postMessage({type:"SET_CENTER",data:JSON.stringify({longitude:e,latitude:t})},"*")},centerChanged:function(e){this.setState({center:e})},zoomChanged:function(e){this.setState({zoom:e})},getVisibleMarkers:function(e){var t=this;new Promise(function(e){window.addEventListener("message",function(t){try{var a=JSON.parse(t.data);"MARKERS"===a.type&&e(a.data)}catch(e){return}}),n.findDOMNode(t.refs.iframe).contentWindow.postMessage({type:"GET_MARKERS"},"*")}).then(function(t){e(t)})},onMapClicked:function(e){this.handleAction(a.siteConstants.ACTION_TYPES.GOOGLE_MAP_CLICKED,e)},onMarkerClicked:function(e){e=t.assign(e,t.pick(e.location,["longitude","latitude"])),this.handleAction(a.siteConstants.ACTION_TYPES.GOOGLE_MAP_MARKER_CLICKED,e)},componentWillReceiveProps:function(e){var a=this.props.isExperimentOpen("sv_googleMapsRevamp"),n=c(e,a);if(!t.isEqual(this.currentMapProperties,n)){if(l(this.props)!==l(e))return void this.restartMap(e);if(this.currentMapProperties=n,!a)return void this.updateMapParams(this.currentMapProperties);var o=this.shouldKeepMarkers(e.compData.locations);this.updateMapParams(this.currentMapProperties,o)}},shouldKeepMarkers:function(e){return t.isEqual(this.props.compData.locations,e)},updateMapParams:function(e,a){n.findDOMNode(this.refs.iframe).contentWindow.postMessage(JSON.stringify(t.assign({},e,{shouldKeepMarkers:!!a})),"*")},restartMap:function(e){this.iframeUrl=function(e){var n=c(e,e.isExperimentOpen("sv_googleMapsRevamp")),o=t.get(n,"locations")?["defaultLocation","showZoom","showStreetView","showMapType","fullscreenControl"]:["lat","long","address","addressInfo","showZoom","showStreetView","showMapType","fullscreenControl"],i=t.pick(n,o),r=t.reduce(i,function(e,t,a){return e.concat("&"+a+"="+t)},""),s=t.get(n,"locations")?"&locations="+JSON.stringify(n.locations):"",p="language="+l(e)+r+s;return a.urlUtils.joinURL(e.santaBase||"","static/external/googleMap.html?"+p)}(e),this.a11yTitle=a.translationsLoader.getTranslation("component_label",l(e),"COMPONENT_LABEL_googleMapsTitle")},getSkinProperties:function(){return{"":{tabIndex:0,title:this.a11yTitle,"aria-label":this.a11yTitle},mapContainer:{key:"mapContainer",children:[e.utils.createReactElement("iframe",{ref:"iframe","data-src":this.iframeUrl,width:"100%",height:"100%",frameBorder:"0",allowFullScreen:!0,scrolling:"no",title:this.a11yTitle,"aria-label":this.a11yTitle})]}}}};return s.compRegistrar.register("wysiwyg.viewer.components.GoogleMap",f),o.translationRequirementsChecker.registerCommonLanguageRequirement("wysiwyg.viewer.components.GoogleMap",function(e,a){return t.get(a,["properties","language"])}),i.skinsMap.addBatch(r),f}.apply(t,n))||(e.exports=o)},779:function(e,t,a){var n;void 0===(n=function(){"use strict";var e={"wysiwyg.viewer.skins.GoogleMapSkin":{react:[["div","mapContainer",[],{}]],css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%mapContainer":"position:absolute;top:0;right:0;bottom:0;left:0;"}},"wysiwyg.viewer.skins.map.GoogleMapDefault":{react:[["div","mapContainer",[],{}]],params:{brd:"BG_COLOR_ALPHA",rd:"BORDER_RADIUS",shd:"BOX_SHADOW",brw:"SIZE"},paramsDefaults:{brd:"color_15",rd:"0",shd:"0 1px 4px rgba(0, 0, 0, 0.6)",brw:"0"},css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%":"background:[brd];[rd]  [shd]","%mapContainer":"display:inline-block;overflow:hidden;[rd]  position:absolute;top:[brw];right:[brw];bottom:[brw];left:[brw];-webkit-mask-image:-webkit-radial-gradient(circle, #fff, #000);mask-image:radial-gradient(circle, #fff, #000);"}},"wysiwyg.viewer.skins.map.GoogleMapLiftedShadow":{react:[["div",null,["_left","_shd"],{}],["div",null,["_right","_shd"],{}],["div","mapContainer",[],{}]],params:{tdr:"URL",brd:"BG_COLOR_ALPHA",rd:"BORDER_RADIUS",shd:"BOX_SHADOW",brw:"SIZE"},paramsDefaults:{tdr:"BASE_THEME_DIRECTORY",brd:"color_15",rd:"0",shd:"0 1px 4px rgba(0, 0, 0, 0.6)",brw:"0"},css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%_shd":"position:absolute;bottom:-26px;width:165px;height:26px;background-image:url([tdr]liftedshadow_medium.png);background-repeat:no-repeat;","%_left":"left:-20px;background-position:0 0;","%_right":"right:-20px;background-position:100% 0;","%":"background-color:[brd];[rd]  [shd]","%mapContainer":"position:absolute;top:[brw];right:[brw];bottom:[brw];left:[brw];overflow:hidden;"}},"wysiwyg.viewer.skins.map.GoogleMapSloppy":{react:[["div",null,["_brd","_one"],{}],["div",null,["_brd","_two"],{}],["div","mapContainer",[],{}]],params:{tdr:"URL"},paramsDefaults:{tdr:"BASE_THEME_DIRECTORY"},css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%_brd":"background-image:url([tdr]sloppyframe.png);background-repeat:no-repeat;position:absolute;top:0;right:0;bottom:0;left:0;","%_one":"background-position:0 0;bottom:3px;right:3px;","%_two":"background-position:100% 100%;top:3px;left:3px;","%mapContainer":"position:absolute;top:9px;bottom:9px;left:9px;right:9px;"}}};return e}.apply(t,[]))||(e.exports=n)}})});
//# sourceMappingURL=googleMap.min.js.map